<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Book a Service</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css">
</head>
<body class="bg-light">
  <div class="container py-5">
    <div class="card shadow-sm">
      <div class="card-body">
        <h3 class="card-title mb-4">Select Services</h3>
        <form id="bookingForm">
          <div class="form-group">
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="matterport">
              <label class="form-check-label" for="matterport">Matterport</label>
            </div>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="floorplan">
              <label class="form-check-label" for="floorplan">Floor Plan</label>
            </div>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="photos">
              <label class="form-check-label" for="photos">Photos</label>
            </div>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="drone">
              <label class="form-check-label" for="drone">Drone</label>
            </div>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="social">
              <label class="form-check-label" for="social">Social Media Video</label>
            </div>
          </div>

          <div class="form-group">
            <label for="sqft">Square Footage</label>
            <select id="sqft" class="form-control" required>
              <option value="">-- Select Size --</option>
              <option value="lt1500">Less than 1500</option>
              <option value="1501-3000">1501 - 3000</option>
              <option value="3001-3999">3001 - 3999</option>
              <option value="gt3000">Greater than 4000</option>
            </select>
          </div>

          <div class="form-group">
            <label for="vacant">Is the property Vacant?</label>
            <select id="vacant" class="form-control" required>
              <option value="">-- Choose One --</option>
              <option value="yes">Yes</option>
              <option value="no">No</option>
            </select>
          </div>

          <div class="alert alert-warning d-none" id="socialNote">
            To book a Social Media Video, please call Cory or Huy directly.
          </div>

          <button type="submit" id="nextBtn" class="btn btn-primary">Continue to Booking</button>
        </form>
      </div>
    </div>
  </div>
  <script>
const activeServices = [
`Drone-15|--15|---P0.0|---D0|----[733431]`,
`Drone-15|--15|---P0.0|---D0|VACANT|----[733424]`,
`Drone-15|FloorPlan-0|Matterport-105|--120|---P25.0|---D25.0|----[733427]`,
`Drone-15|FloorPlan-0|Matterport-105|--120|---P25.0|---D25.0|VACANT|----[733425]`,
`Drone-15|FloorPlan-0|Matterport-105|Photos-45|--165|---P25.0|---D25.0|----[733426]`,
`Drone-15|FloorPlan-0|Matterport-105|Photos-45|--165|---P25.0|---D25.0|VACANT|----[733428]`,
`Drone-15|FloorPlan-0|Matterport-105|Photos-45|SocialMediaVideo-50|--215|---P75.0|---D75.0|----[733435]`,
`Drone-15|FloorPlan-0|Matterport-105|Photos-45|SocialMediaVideo-50|--215|---P75.0|---D75.0|VACANT|----[733430]`,
`Drone-15|FloorPlan-0|Matterport-105|SocialMediaVideo-50|--170|---P75.0|---D75.0|----[733436]`,
`Drone-15|FloorPlan-0|Matterport-105|SocialMediaVideo-50|--170|---P75.0|---D75.0|VACANT|----[733437]`,
`Drone-15|FloorPlan-0|Matterport-120|--135|---P25.0|---D25.0|----[733419]`,
`Drone-15|FloorPlan-0|Matterport-120|--135|---P25.0|---D25.0|VACANT|----[733432]`,
`Drone-15|FloorPlan-0|Matterport-120|Photos-60|--195|---P25.0|---D25.0|----[733421]`,
`Drone-15|FloorPlan-0|Matterport-120|Photos-60|--195|---P25.0|---D25.0|VACANT|----[733434]`,
`Drone-15|FloorPlan-0|Matterport-120|Photos-60|SocialMediaVideo-60|--255|---P75.0|---D75.0|----[733438]`,
`Drone-15|FloorPlan-0|Matterport-120|Photos-60|SocialMediaVideo-60|--255|---P75.0|---D75.0|VACANT|----[733423]`,
`Drone-15|FloorPlan-0|Matterport-120|SocialMediaVideo-60|--195|---P75.0|---D75.0|----[733422]`,
`Drone-15|FloorPlan-0|Matterport-120|SocialMediaVideo-60|--195|---P75.0|---D75.0|VACANT|----[733433]`,
`Drone-15|FloorPlan-0|Matterport-50|--65|---P25.0|---D25.0|----[733429]`,
`Drone-15|FloorPlan-0|Matterport-50|--65|---P25.0|---D25.0|VACANT|----[733420]`,
`Drone-15|FloorPlan-0|Matterport-50|Photos-15|--80|---P25.0|---D25.0|----[733440]`,
`Drone-15|FloorPlan-0|Matterport-50|Photos-15|--80|---P25.0|---D25.0|VACANT|----[733443]`,
`Drone-15|FloorPlan-0|Matterport-50|Photos-15|SocialMediaVideo-30|--110|---P75.0|---D75.0|----[733439]`,
`Drone-15|FloorPlan-0|Matterport-50|Photos-15|SocialMediaVideo-30|--110|---P75.0|---D75.0|VACANT|----[733441]`,
`Drone-15|FloorPlan-0|Matterport-50|SocialMediaVideo-30|--95|---P75.0|---D75.0|----[733444]`,
`Drone-15|FloorPlan-0|Matterport-50|SocialMediaVideo-30|--95|---P75.0|---D75.0|VACANT|----[733445]`,
`Drone-15|FloorPlan-0|Matterport-75|--90|---P25.0|---D25.0|----[733446]`,
`Drone-15|FloorPlan-0|Matterport-75|--90|---P25.0|---D25.0|VACANT|----[733442]`,
`Drone-15|FloorPlan-0|Matterport-75|Photos-30|--120|---P25.0|---D25.0|----[733447]`,
`Drone-15|FloorPlan-0|Matterport-75|Photos-30|--120|---P25.0|---D25.0|VACANT|----[733448]`,
`Drone-15|FloorPlan-0|Matterport-75|Photos-30|SocialMediaVideo-40|--160|---P75.0|---D75.0|----[733449]`,
`Drone-15|FloorPlan-0|Matterport-75|Photos-30|SocialMediaVideo-40|--160|---P75.0|---D75.0|VACANT|----[733452]`,
`Drone-15|FloorPlan-0|Matterport-75|SocialMediaVideo-40|--130|---P75.0|---D75.0|----[733450]`,
`Drone-15|FloorPlan-0|Matterport-75|SocialMediaVideo-40|--130|---P75.0|---D75.0|VACANT|----[733451]`,
`Drone-15|Matterport-105|--120|---P0.0|---D0|----[733454]`,
`Drone-15|Matterport-105|--120|---P0.0|---D0|VACANT|----[733456]`,
`Drone-15|Matterport-105|Photos-45|--165|---P0.0|---D0|----[733457]`,
`Drone-15|Matterport-105|Photos-45|--165|---P0.0|---D0|VACANT|----[733453]`,
`Drone-15|Matterport-105|Photos-45|SocialMediaVideo-50|--215|---P50.0|---D50.0|----[733455]`,
`Drone-15|Matterport-105|Photos-45|SocialMediaVideo-50|--215|---P50.0|---D50.0|VACANT|----[733458]`,
`Drone-15|Matterport-105|SocialMediaVideo-50|--170|---P50.0|---D50.0|----[733459]`,
`Drone-15|Matterport-105|SocialMediaVideo-50|--170|---P50.0|---D50.0|VACANT|----[733460]`,
`Drone-15|Matterport-120|--135|---P0.0|---D0|----[733461]`,
`Drone-15|Matterport-120|--135|---P0.0|---D0|VACANT|----[733465]`,
`Drone-15|Matterport-120|Photos-60|--195|---P0.0|---D0|----[733463]`,
`Drone-15|Matterport-120|Photos-60|--195|---P0.0|---D0|VACANT|----[733466]`,
`Drone-15|Matterport-120|Photos-60|SocialMediaVideo-60|--255|---P50.0|---D50.0|----[733464]`,
`Drone-15|Matterport-120|Photos-60|SocialMediaVideo-60|--255|---P50.0|---D50.0|VACANT|----[733462]`,
`Drone-15|Matterport-120|SocialMediaVideo-60|--195|---P50.0|---D50.0|----[733467]`,
`Drone-15|Matterport-120|SocialMediaVideo-60|--195|---P50.0|---D50.0|VACANT|----[733468]`,
`Drone-15|Matterport-50|--65|---P0.0|---D0|----[733469]`,
`Drone-15|Matterport-50|--65|---P0.0|---D0|VACANT|----[733470]`,
`Drone-15|Matterport-50|Photos-15|--80|---P0.0|---D0|----[733472]`,
`Drone-15|Matterport-50|Photos-15|--80|---P0.0|---D0|VACANT|----[733471]`,
`Drone-15|Matterport-50|Photos-15|SocialMediaVideo-30|--110|---P50.0|---D50.0|----[733474]`,
`Drone-15|Matterport-50|Photos-15|SocialMediaVideo-30|--110|---P50.0|---D50.0|VACANT|----[733473]`,
`Drone-15|Matterport-50|SocialMediaVideo-30|--95|---P50.0|---D50.0|----[733475]`,
`Drone-15|Matterport-50|SocialMediaVideo-30|--95|---P50.0|---D50.0|VACANT|----[733478]`,
`Drone-15|Matterport-75|--90|---P0.0|---D0|----[733476]`,
`Drone-15|Matterport-75|--90|---P0.0|---D0|VACANT|----[733477]`,
`Drone-15|Matterport-75|Photos-30|--120|---P0.0|---D0|----[733479]`,
`Drone-15|Matterport-75|Photos-30|--120|---P0.0|---D0|VACANT|----[733480]`,
`Drone-15|Matterport-75|Photos-30|SocialMediaVideo-40|--160|---P50.0|---D50.0|----[733486]`,
`Drone-15|Matterport-75|Photos-30|SocialMediaVideo-40|--160|---P50.0|---D50.0|VACANT|----[733482]`,
`Drone-15|Matterport-75|SocialMediaVideo-40|--130|---P50.0|---D50.0|----[733481]`,
`Drone-15|Matterport-75|SocialMediaVideo-40|--130|---P50.0|---D50.0|VACANT|----[733485]`,
`Drone-15|Photos-15|--30|---P0.0|---D0|----[733487]`,
`Drone-15|Photos-15|--30|---P0.0|---D0|VACANT|----[733483]`,
`Drone-15|Photos-15|SocialMediaVideo-30|--60|---P50.0|---D50.0|----[733490]`,
`Drone-15|Photos-15|SocialMediaVideo-30|--60|---P50.0|---D50.0|VACANT|----[733488]`,
`Drone-15|Photos-30|--45|---P0.0|---D0|----[733489]`,
`Drone-15|Photos-30|--45|---P0.0|---D0|VACANT|----[733484]`,
`Drone-15|Photos-30|SocialMediaVideo-40|--85|---P50.0|---D50.0|----[733491]`,
`Drone-15|Photos-30|SocialMediaVideo-40|--85|---P50.0|---D50.0|VACANT|----[733494]`,
`Drone-15|Photos-45|--60|---P0.0|---D0|----[733493]`,
`Drone-15|Photos-45|--60|---P0.0|---D0|VACANT|----[733492]`,
`Drone-15|Photos-45|SocialMediaVideo-50|--110|---P50.0|---D50.0|----[733496]`,
`Drone-15|Photos-45|SocialMediaVideo-50|--110|---P50.0|---D50.0|VACANT|----[733495]`,
`Drone-15|Photos-60|--75|---P0.0|---D0|----[733497]`,
`Drone-15|Photos-60|--75|---P0.0|---D0|VACANT|----[733498]`,
`Drone-15|Photos-60|SocialMediaVideo-60|--135|---P50.0|---D50.0|----[733499]`,
`Drone-15|Photos-60|SocialMediaVideo-60|--135|---P50.0|---D50.0|VACANT|----[733500]`,
`Drone-15|SocialMediaVideo-30|--45|---P50.0|---D50.0|----[733502]`,
`Drone-15|SocialMediaVideo-30|--45|---P50.0|---D50.0|VACANT|----[733501]`,
`Drone-15|SocialMediaVideo-40|--55|---P50.0|---D50.0|----[733505]`,
`Drone-15|SocialMediaVideo-40|--55|---P50.0|---D50.0|VACANT|----[733504]`,
`Drone-15|SocialMediaVideo-50|--65|---P50.0|---D50.0|----[733503]`,
`Drone-15|SocialMediaVideo-50|--65|---P50.0|---D50.0|VACANT|----[733507]`,
`Drone-15|SocialMediaVideo-60|--75|---P50.0|---D50.0|----[733506]`,
`Drone-15|SocialMediaVideo-60|--75|---P50.0|---D50.0|VACANT|----[733508]`,
`FloorPlan-0|Matterport-105|--105|---P25.0|---D25.0|----[733509]`,
`FloorPlan-0|Matterport-105|--105|---P25.0|---D25.0|VACANT|----[733510]`,
`FloorPlan-0|Matterport-105|Photos-45|--150|---P25.0|---D25.0|----[733514]`,
`FloorPlan-0|Matterport-105|Photos-45|--150|---P25.0|---D25.0|VACANT|----[733512]`,
`FloorPlan-0|Matterport-105|Photos-45|SocialMediaVideo-50|--200|---P75.0|---D75.0|----[733511]`,
`FloorPlan-0|Matterport-105|Photos-45|SocialMediaVideo-50|--200|---P75.0|---D75.0|VACANT|----[733513]`,
`FloorPlan-0|Matterport-105|SocialMediaVideo-50|--155|---P75.0|---D75.0|----[733515]`,
`FloorPlan-0|Matterport-105|SocialMediaVideo-50|--155|---P75.0|---D75.0|VACANT|----[733516]`,
`FloorPlan-0|Matterport-120|--120|---P25.0|---D25.0|----[733517]`,
`FloorPlan-0|Matterport-120|--120|---P25.0|---D25.0|VACANT|----[733518]`,
`FloorPlan-0|Matterport-120|Photos-60|--180|---P25.0|---D25.0|----[733519]`,
`FloorPlan-0|Matterport-120|Photos-60|--180|---P25.0|---D25.0|VACANT|----[733524]`,
`FloorPlan-0|Matterport-120|Photos-60|SocialMediaVideo-60|--240|---P75.0|---D75.0|----[733520]`,
`FloorPlan-0|Matterport-120|Photos-60|SocialMediaVideo-60|--240|---P75.0|---D75.0|VACANT|----[733521]`,
`FloorPlan-0|Matterport-120|SocialMediaVideo-60|--180|---P75.0|---D75.0|----[733522]`,
`FloorPlan-0|Matterport-120|SocialMediaVideo-60|--180|---P75.0|---D75.0|VACANT|----[733523]`,
`FloorPlan-0|Matterport-50|--50|---P25.0|---D25.0|----[733528]`,
`FloorPlan-0|Matterport-50|--50|---P25.0|---D25.0|VACANT|----[733526]`,
`FloorPlan-0|Matterport-50|Photos-15|--65|---P25.0|---D25.0|----[733525]`,
`FloorPlan-0|Matterport-50|Photos-15|--65|---P25.0|---D25.0|VACANT|----[733527]`,
`FloorPlan-0|Matterport-50|Photos-15|SocialMediaVideo-30|--95|---P75.0|---D75.0|----[733529]`,
`FloorPlan-0|Matterport-50|Photos-15|SocialMediaVideo-30|--95|---P75.0|---D75.0|VACANT|----[733530]`,
`FloorPlan-0|Matterport-50|SocialMediaVideo-30|--80|---P75.0|---D75.0|----[733532]`,
`FloorPlan-0|Matterport-50|SocialMediaVideo-30|--80|---P75.0|---D75.0|VACANT|----[733531]`,
`FloorPlan-0|Matterport-75|--75|---P25.0|---D25.0|----[733533]`,
`FloorPlan-0|Matterport-75|--75|---P25.0|---D25.0|VACANT|----[733534]`,
`FloorPlan-0|Matterport-75|Photos-30|--105|---P25.0|---D25.0|----[733536]`,
`FloorPlan-0|Matterport-75|Photos-30|--105|---P25.0|---D25.0|VACANT|----[733535]`,
`FloorPlan-0|Matterport-75|Photos-30|SocialMediaVideo-40|--145|---P75.0|---D75.0|----[733537]`,
`FloorPlan-0|Matterport-75|Photos-30|SocialMediaVideo-40|--145|---P75.0|---D75.0|VACANT|----[733538]`,
`FloorPlan-0|Matterport-75|SocialMediaVideo-40|--115|---P75.0|---D75.0|----[733540]`,
`FloorPlan-0|Matterport-75|SocialMediaVideo-40|--115|---P75.0|---D75.0|VACANT|----[733539]`,
`Matterport-105|--105|---P0.0|---D0|----[733543]`,
`Matterport-105|--105|---P0.0|---D0|VACANT|----[733541]`,
`Matterport-105|Photos-45|--150|---P0.0|---D0|----[733542]`,
`Matterport-105|Photos-45|--150|---P0.0|---D0|VACANT|----[733544]`,
`Matterport-105|Photos-45|SocialMediaVideo-50|--200|---P50.0|---D50.0|----[733545]`,
`Matterport-105|Photos-45|SocialMediaVideo-50|--200|---P50.0|---D50.0|VACANT|----[733546]`,
`Matterport-105|SocialMediaVideo-50|--155|---P50.0|---D50.0|----[733549]`,
`Matterport-105|SocialMediaVideo-50|--155|---P50.0|---D50.0|VACANT|----[733547]`,
`Matterport-120|--120|---P0.0|---D0|----[733550]`,
`Matterport-120|--120|---P0.0|---D0|VACANT|----[733548]`,
`Matterport-120|Photos-60|--180|---P0.0|---D0|----[733551]`,
`Matterport-120|Photos-60|--180|---P0.0|---D0|VACANT|----[733552]`,
`Matterport-120|Photos-60|SocialMediaVideo-60|--240|---P50.0|---D50.0|----[733553]`,
`Matterport-120|Photos-60|SocialMediaVideo-60|--240|---P50.0|---D50.0|VACANT|----[733555]`,
`Matterport-120|SocialMediaVideo-60|--180|---P50.0|---D50.0|----[733554]`,
`Matterport-120|SocialMediaVideo-60|--180|---P50.0|---D50.0|VACANT|----[733557]`,
`Matterport-50|--50|---P0.0|---D0|----[733556]`,
`Matterport-50|--50|---P0.0|---D0|VACANT|----[733558]`,
`Matterport-50|Photos-15|--65|---P0.0|---D0|----[733559]`,
`Matterport-50|Photos-15|--65|---P0.0|---D0|VACANT|----[733561]`,
`Matterport-50|Photos-15|SocialMediaVideo-30|--95|---P50.0|---D50.0|----[733560]`,
`Matterport-50|Photos-15|SocialMediaVideo-30|--95|---P50.0|---D50.0|VACANT|----[733562]`,
`Matterport-50|SocialMediaVideo-30|--80|---P50.0|---D50.0|----[733564]`,
`Matterport-50|SocialMediaVideo-30|--80|---P50.0|---D50.0|VACANT|----[733565]`,
`Matterport-75|--75|---P0.0|---D0|----[733563]`,
`Matterport-75|--75|---P0.0|---D0|VACANT|----[733566]`,
`Matterport-75|Photos-30|--105|---P0.0|---D0|----[733568]`,
`Matterport-75|Photos-30|--105|---P0.0|---D0|VACANT|----[733567]`,
`Matterport-75|Photos-30|SocialMediaVideo-40|--145|---P50.0|---D50.0|----[733569]`,
`Matterport-75|Photos-30|SocialMediaVideo-40|--145|---P50.0|---D50.0|VACANT|----[733570]`,
`Matterport-75|SocialMediaVideo-40|--115|---P50.0|---D50.0|----[733571]`,
`Matterport-75|SocialMediaVideo-40|--115|---P50.0|---D50.0|VACANT|----[733572]`,
`Photos-15|--15|---P0.0|---D0|----[733573]`,
`Photos-15|--15|---P0.0|---D0|VACANT|----[733574]`,
`Photos-15|SocialMediaVideo-30|--45|---P50.0|---D50.0|----[733575]`,
`Photos-15|SocialMediaVideo-30|--45|---P50.0|---D50.0|VACANT|----[733576]`,
`Photos-30|--30|---P0.0|---D0|----[733577]`,
`Photos-30|--30|---P0.0|---D0|VACANT|----[733578]`,
`Photos-30|SocialMediaVideo-40|--70|---P50.0|---D50.0|----[733579]`,
`Photos-30|SocialMediaVideo-40|--70|---P50.0|---D50.0|VACANT|----[733581]`,
`Photos-45|--45|---P0.0|---D0|----[733580]`,
`Photos-45|--45|---P0.0|---D0|VACANT|----[733582]`,
`Photos-45|SocialMediaVideo-50|--95|---P50.0|---D50.0|----[733583]`,
`Photos-45|SocialMediaVideo-50|--95|---P50.0|---D50.0|VACANT|----[733584]`,
`Photos-60|--60|---P0.0|---D0|----[733586]`,
`Photos-60|--60|---P0.0|---D0|VACANT|----[733585]`,
`Photos-60|SocialMediaVideo-60|--120|---P50.0|---D50.0|----[733587]`,
`Photos-60|SocialMediaVideo-60|--120|---P50.0|---D50.0|VACANT|----[733589]`,
`SocialMediaVideo-30|--30|---P50.0|---D50.0|----[733588]`,
`SocialMediaVideo-30|--30|---P50.0|---D50.0|VACANT|----[733590]`,
`SocialMediaVideo-40|--40|---P50.0|---D50.0|----[733591]`,
`SocialMediaVideo-40|--40|---P50.0|---D50.0|VACANT|----[733592]`,
`SocialMediaVideo-50|--50|---P50.0|---D50.0|----[733594]`,
`SocialMediaVideo-50|--50|---P50.0|---D50.0|VACANT|----[733593]`,
`SocialMediaVideo-60|--60|---P50.0|---D50.0|----[733595]`,
`SocialMediaVideo-60|--60|---P50.0|---D50.0|VACANT|----[733596]`
];
const durations = {
  "Matterport": [50, 75, 105, 120],
  "FloorPlan": [0, 0, 0, 0],
  "Photos": [15, 30, 45, 60],
  "Drone": [15, 15, 15, 15],
  "SocialVideo": [30, 40, 50, 60]
};
const serviceOrder = ["Drone", "FloorPlan", "Matterport", "Photos", "SocialVideo"];
function sqftToIdx(sqft) {
  if (sqft === "lt1500") return 0;
  if (sqft === "1501-3000") return 1;
  if (sqft === "3001-3999") return 2;
  if (sqft === "gt3000") return 3;
  return 0;
};

const idToServiceName = {
  "drone": "Drone",
  "floorplan": "FloorPlan",
  "matterport": "Matterport",
  "photos": "Photos",
  "social": "SocialVideo"
};


function normalizeKey(key) {
  let serviceParts = key.split("|").filter(x =>
    serviceOrder.some(service => x.startsWith(service + "-"))
  );
  let isVacant = key.includes("VACANT");
  serviceParts.sort((a, b) => {
    let ai = serviceOrder.findIndex(s => a.startsWith(s));
    let bi = serviceOrder.findIndex(s => b.startsWith(s));
    return ai - bi;
  });
  if (isVacant) serviceParts.push("VACANT");
  return serviceParts.join("|");
};

document.getElementById("bookingForm").onsubmit = function(e) {
  e.preventDefault();
  const sqft = document.getElementById("sqft").value;
  const vacant = document.getElementById("vacant").value;
  if (!sqft) {
    alert("Please select square footage.");
    return;
  }
  if (!vacant) {
    alert("Please indicate if the property is vacant.");
    return;
  }
  const idx = sqftToIdx(sqft);
  let parts = [];
  for (const id in idToServiceName) {
    if (document.getElementById(id).checked) {
      const svc = idToServiceName[id];
      const durArr = durations[svc];
      let duration = durArr[Math.min(idx, durArr.length-1)];
      parts.push(svc + "-" + duration);
    }
  }
  // Sort by serviceOrder to ensure consistent key (order matters for matching)
  parts.sort((a, b) => {
    let ai = serviceOrder.indexOf(a.split("-")[0]);
    let bi = serviceOrder.indexOf(b.split("-")[0]);
    return ai - bi;
  });
  if (parts.length === 0) {
    alert("Please select at least one service.");
    return;
  }
  let key = parts.join("|");
  if (vacant === "yes") key += "|VACANT";
  // Matching logic
  function getServiceKeyOnly(str) {
    return str.split("|")
        .filter(x => serviceOrder.some(s => x.startsWith(s + "-")) || x === "VACANT")
        .sort((a, b) => {
            let ai = serviceOrder.indexOf(a.split("-")[0]);
            let bi = serviceOrder.indexOf(b.split("-")[0]);
            return ai - bi;
        })
        .join("|");
}

let found = null;
let keyNormalized = getServiceKeyOnly(key);
for (const line of activeServices) {
    let lineKey = getServiceKeyOnly(line);
    if (lineKey === keyNormalized) {
        found = line;
        break;
    }
}

  if (!found) {
    alert("No matching service combination found. Please contact the office.\n\nDEBUG KEY: " + key);
    return;
  }
  const match = found.match(/\[(\d+)\]/);
  if (!match) {
    alert("No service ID found for this selection.");
    return;
  }
  const serviceId = match[1];
  window.location.href = `https://booking99.timetap.com/?rid=${serviceId}#/`;
};


</script>
</body>
</html>

